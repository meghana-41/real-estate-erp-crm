Custom hook for authentication logic.